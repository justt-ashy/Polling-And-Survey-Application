<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Polystics // Create Poll</title>
    <link rel="icon" type="image/png" href="polystics.png" />
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: #1c1b28;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-image: url(blob-haikei.svg);
        background-size: cover;
        background-position: center center;
        background-repeat: no-repeat;
      }
      .container {
        background-color: #ddc864;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
        text-align: center;
        max-width: 400px;
        width: 100%;
        box-sizing: border-box;
      }
      h1 {
        color: #333;
      }
      form {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      label {
        margin-bottom: 8px;
      }
      input {
        padding: 10px;
        margin-bottom: 16px;
        width: 100%;
        box-sizing: border-box;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      button {
        background-color: #229ec6;
        color: #fff;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
      }
      button:hover {
        background-color: #c183b8;
      }
      .poll-list {
        margin-top: 20px;
        list-style-type: none;
        padding: 0;
      }
      .poll-item {
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-bottom: 8px;
        padding: 10px;
        box-sizing: border-box;
      }
      .option-list {
        display: flex;
        justify-content: space-between;
        margin-top: 10px;
      }
      .result-container {
        margin-top: 10px;
      }

      .result-slider {
        width: 100%;
        height: 20px;
        background-color: #ddd;
        border-radius: 4px;
        overflow: hidden;
      }

      .result-fill {
        height: 100%;
        background-color: #4caf50;
      }
      @media screen and (max-width: 600px) {
        .container {
          max-width: 90%;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Polystics</h1>
      <form id="pollForm">
        <label for="question">Question:</label>
        <input type="text" id="question" name="question" required />

        <label for="options">Options (comma-separated):</label>
        <input type="text" id="options" name="options" required />

        <button type="button" onclick="createPoll()">Create Poll</button>
      </form>

      <h2 class="poll-list">Poll List</h2>
      <ul id="pollList" class="poll-list"></ul>
    </div>

    <script>
      // Function to create a new poll
      function createPoll() {
        const question = document.getElementById("question").value;
        const options = document.getElementById("options").value.split(",");

        // Create a new poll object
        const newPoll = {
          question,
          options,
          votes: Array(options.length).fill(0),
        };

        // Add the new poll to the list
        polls.push(newPoll);

        // Display the updated list
        displayPolls();

        // Clear the form
        document.getElementById("pollForm").reset();
      }

      // Function to display all polls
      function displayPolls() {
        const pollList = document.getElementById("pollList");
        pollList.innerHTML = ""; // Clear previous list

        // Display each poll in the list
        polls.forEach((poll, pollIndex) => {
          const li = document.createElement("li");
          li.className = "poll-item";
          li.textContent = poll.question;

          const optionList = document.createElement("ul");
          optionList.className = "option-list";

          // Create a radio button for each option
          poll.options.forEach((option, optionIndex) => {
            const inputId = `pollOption_${pollIndex}_${optionIndex}`;
            const radio = document.createElement("input");
            radio.setAttribute("type", "radio");
            radio.setAttribute("id", inputId);
            radio.setAttribute("name", `pollOption_${pollIndex}`);
            radio.setAttribute("value", option);

            const label = document.createElement("label");
            label.setAttribute("for", inputId);
            label.textContent = option;

            const optionItem = document.createElement("li");
            optionItem.appendChild(radio);
            optionItem.appendChild(label);
            optionList.appendChild(optionItem);
          });

          li.appendChild(optionList);

          // Add button for showing results
          const showResultsButton = document.createElement("button");
          showResultsButton.textContent = "Show Results";
          showResultsButton.addEventListener("click", () =>
            showResults(pollIndex)
          );

          li.appendChild(showResultsButton);

          pollList.appendChild(li);
        });
      }

      // Function to show poll results
      function showResults(pollIndex) {
        const poll = polls[pollIndex];
        const totalVotes = poll.votes.reduce(
          (total, count) => total + count,
          0
        );

        if (totalVotes === 0) {
          alert("No votes yet.");
          return;
        }

        const percentages = poll.votes.map(
          (count) => (count / totalVotes) * 100
        );

        // Display the results
        alert(
          poll.options
            .map(
              (option, optionIndex) =>
                `${option}: ${percentages[optionIndex].toFixed(2)}%`
            )
            .join("\n")
        );
      }

      // Initial array to store polls
      const polls = [];

      // Initial load of polls
      displayPolls();
    </script>
  </body>
</html>
